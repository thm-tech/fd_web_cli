"use strict";define(["angular","app","services/authorization"],function(a,b){b.controller("mtaccountCtrl",["$scope","$rootScope","$http","$location","authorization",function(a,b,c,d,e){document.title="聊天室 -喵喵熊";var f=a.accountInfo={},g=b.proxyUrl,h=b.globals.shop_id;a.chatObj={},a.chatObj.messageNum="",a.overScroll=!1,f.accountName=b.globals.username,f.status=b.globals.merchant_service_status,f.pfPhone=b.serviceTEL;var i=d.path().split("/"),j=function(){2==f.status?(a.service=!0,a.navList=["#/merchant/account","#/merchant/account/fans","#/merchant/account/goods","#/merchant/account/activity","#/merchant/account/shop"]):(a.service=!1,a.navList=["#/merchant/account","#/merchant/account","#/merchant/account","#/merchant/account","#/merchant/account"],1==f.status?(f.statusStr="审核中...",f.remindStr="如有疑问请致电"):3==f.status?(f.statusStr="您已欠费,请及时",f.remindStr="如有疑问请致电"):4==f.status?(f.statusStr="审核未通过",f.remindStr="如有疑问请致电"):5==f.status&&(f.statusStr="服务期满,请",f.remindStr="如有疑问请致电"))},k=function(){i[3]?(a.curNav=i[3],a.chat=!1,a.noservice=!1):(a.curNav="chatroom",a.chat=!0,a.noservice=!0)};window.onscroll=function(){var b=document.documentElement.scrollTop||document.body.scrollTop;a.$apply(b>90?function(){a.overScroll=!0}:function(){a.overScroll=!1})};var l=function(){var a=g+"/merchant/"+h+"/info";c.get(a).success(function(a){f.portraitUrl=a.portrait_url})};a.$on("changeHead",function(a,b){f.portraitUrl=b,broadcast("_changeHead",b)}),a.$on("changeName",function(a,b){f.accountName=b,broadcast("_changeName",b)});var m=0;a.$on("msgChange",function(){"chatroom"!=a.curNav?(m++,a.chatObj.messageNum=99>=m?m.toString():"99+",a.$digest()):(m=0,a.chatObj.messageNum="",a.$digest())}),a.modNav=function(b){this.tar=b.target.attributes.data.value,"chatroom"==this.tar?(document.title="聊天室 -喵喵熊",a.chat=!0,m=0,a.chatObj.messageNum=""):a.chat=!1,a.noservice=!0,a.curNav=this.tar},a.modNav2=function(b){this.tar=b.target.attributes.data.value,a.noservice=!1,a.chat=!1,a.curNav=this.tar},a.logout=function(){document.title="喵喵熊 妙生活",e.clearCredentials(),c.get(g+"/merchant/logout").success(function(a){}).error(function(a){}),a.$broadcast("logout"),d.path("/index")},l(),j(),k()}])});