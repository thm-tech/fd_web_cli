"use strict";Array.prototype.remove=function(a){var b=this.indexOf(a);b>-1&&this.splice(b,1)},define(["angular","app","md5","directives/remoteValidation","directives/checkcaptcha"],function(a,b){b.controller("mtregisterCtrl",["$scope","$rootScope","$http","$filter","$interval",function(a,b,c,d,e){document.title="商家入驻 -喵喵熊";var f=b.proxyUrl;a.regaccount=!0,a.completeinfo=!1,a.waitcheck=!1;var g=a.user={};a.reggg=function(){a.regaccount=!0,a.completeinfo=!1,a.waitcheck=!1},a.reg=function(){a.regaccount=!1,a.completeinfo=!0,a.waitcheck=!1},a.getcap=!1;var h=a.res={};h.sCount=60,a.resend="重新发送("+h.sCount+")",a.Getcaptcha=function(){a.getcap=!0,e(function(){h.sCount>1?h.sCount=h.sCount-1:(a.getcap=!1,h.sCount=60)},1e3,60),c.get(f+"/basic/phonevalidate/"+a.telephone_no).success(function(){})},a.$watch("res.sCount",function(b){a.resend="重新发送("+h.sCount+")"}),c.get(f+"/basic/goodscategories?type=all_tree").success(function(b){a.cate=b.goodscategories,a.choseccates=function(b){a.category_list=b.name,a.cateid=b.id}}),c.get(f+"/basic/cities").success(function(b){a.citylist=b.cities,a.city_id=a.citylist[0].city_id,c.get(f+"/basic/districts?city_id="+a.city_id).success(function(b){a.districtlist=b.districts})}),a.myMarkers=[];var i=null;a.mapOptions={ngCenter:{lat:31.879624,lng:117.119888},ngZoom:13,toolbar:!0,scrollzoom:!0,maptype:!0,overview:!0,locatecity:!1,resizeEnable:!1},a.changemapcenter=function(){c.get(f+"/basic/districts?city_id="+a.city_id).success(function(b){a.districtlist=b.districts}),a.$watch("maparea",function(b){c.get(f+"/basic/city/"+a.city_id).success(function(c){a.cityname=c.city_name,b.centerAndZoom(a.cityname,13),b.enableDragging(),b.checkResize(),b.addControl(new BMap.NavigationControl),b.addControl(new BMap.ScaleControl),b.setDefaultCursor("crosshair"),b.enableContinuousZoom(),b.enableScrollWheelZoom(),b.highResolutionEnabled()})})},a.enter=function(b){a.$watch("maparea",function(c){if(13===b.keyCode){var d=new BMap.LocalSearch(c,{renderOptions:{map:c,autoViewport:!0}});c.clearOverlays(),d.search(a.position)}})},a.$watch("maparea",function(b){a.mapsearch=function(){var c=new BMap.LocalSearch(b,{renderOptions:{map:b,autoViewport:!0}});b.clearOverlays(),c.search(a.position)}}),a.addMarker=function(b,c){i&&a.maparea.removeOverlay(i);var d=new BMap.Marker(c[0].point);a.myMarkers.push(d),a.maparea.addOverlay(d),a.latitude=a.currentMarkerLat=d.getPosition().lat,a.longitude=a.currentMarkerLng=d.getPosition().lng,i=d,a.mapmark="经度"+a.longitude+"   纬度"+a.latitude},a.setZoomMessage=function(b){a.zoomMessage="You just zoomed to "+b+"!"},a.openMarkerInfo=function(b,c){b.preventDefault(),b.stopPropagation(),a.currentMarker=c,a.currentMarkerLat=c.getPosition().lat,a.currentMarkerLng=c.getPosition().lng,a.maparea.addOverlay(a.myInfoWindow),a.maparea.openInfoWindow(a.myInfoWindow,c.getPosition())},a.setMarkerPosition=function(a,b,c){a.setPosition(new BMap.Point(c,b))},a.regshop=function(){var b={account:g.account,password:hex_md5(g.password),contact_name:a.contact_name,contact_phone_no:a.contact_phone_no,brand_name:a.brand_name,shop_name:a.shop_name,business_hours:a.business_hours,telephone_no:a.telephone_no,city_id:a.city_id,district_id:a.district_id,business_area:a.business_area,address:a.address,longitude:a.longitude,latitude:a.latitude,category_list:a.cateid};c.post(f+"/merchant",b).success(function(b){b.is_success===!1?g.feedres=!0:(a.completeinfo=!1,a.waitcheck=!0)})},g.tologin=function(){window.location.href="#/merchant/login"}}]),b.controller("PartnerCtrl",["$scope","$rootScope","$http",function(a,b,c){document.title="入驻商家 -喵喵熊";var d=b.proxyUrl;c.get(d+"/basic/joinshops?offset=0&limit=16").success(function(b){a.shopinfo=b.shops})}]),b.controller("aboutCtrl",[function(){document.title="关于我们 -喵喵熊"}]),b.controller("mainCtrl",[function(){document.title="喵喵熊 妙生活"}])});