"use strict";define(["angular","app","services/checkcookie"],function(a,b){b.controller("activityCtrl",["$scope","$rootScope","$http","$sce","hascookie",function(b,c,d,e,f){var g=9,h=5,i=b.act={},j=c.proxyUrl,k=j+"/user/activity";i.fromHome=!1,i.a={},i.a.b=1,b.$on("intoAct",function(a,c){b.$emit("recvAct"),i.actStatus={},void 0!=c.cid?(document.title="活动专区-喵喵熊",i.cid=c.cid,i.actStatus.showList=!0,i.getAct(0)):void 0!=c.activity&&(i.fromHome=!0,i.showActDet(c.activity))}),i.getAct=function(a){d({url:k,method:"GET",params:{city:i.cid,offset:a,count:g}}).success(function(a){0==a.err&&(i.totalAct=a.count,i.actList=a.actList)}).error()},i.showActDet=function(b){if(f.check("cm")){document.title=b.title+"-喵喵熊";var c=new Object;a.copy(b,c),console.log("this is activity in act"),console.log(c);for(var d,g=740,h=new RegExp("height:(.*?)px; width:(.*?)px",["g"]),j=c.content;d=h.exec(j);)if(d[2]>g){var k=g,l=d[1]*g/d[2];j=j.replace(d[0],"height:"+String(l)+"px; width:"+String(k)+"px")}console.log("html,"+j),c.content=e.trustAsHtml(j),c.bt=c.bt.split(" ")[0],c.et=c.et.split(" ")[0],console.log("showactdet"),i.actDet=c,i.actStatus.showList=!1}},i.curPage=1,i.itemsPerPage=g,i.maxSize=h,i.selectPage=function(a){console.log("pageNum,"+a);var b=(a-1)*i.itemsPerPage;i.actList=[],i.getAct(b)},i.intoShop=function(a,c){if(f.check("cm")){var d={sid:a,sname:c};b.$emit("actToShop",d)}},i.sendAct=function(a,c,d){if(f.check("cm")){var e={type:"act",id:a,name:c,img:d};b.$emit("_sendObjChannel",e)}},i.closeList=function(){b.$emit("closeActList")},i.closeDet=function(){i.fromHome?b.$emit("closeActDet1"):(document.title="活动专区-喵喵熊",i.actStatus.showList=!0)}}])});