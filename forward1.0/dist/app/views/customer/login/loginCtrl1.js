"use strict";define(["angular","app","md5","services/authorization","services/rememberMe"],function(a,b){b.controller("cmLoginCtrl",["$scope","$rootScope","$http","$location","authorization","remember",function(a,b,c,d,e,f){var g=b.proxyUrl,h=g+"/user/login",i=0,j={},k={},l=a.userInfo={},m={},n=a._alert={};a.logSucceed=!0,a.remember=!0;var o={type:"danger",msg:"用户名或密码错误!"};n.alerts=[],n.alerts.push(o),n.closeAlert=function(a){n.alerts.splice(a,1)},a.changeLoginTab=function(){console.log("mer"),d.path("/merchant/login")};var p=new RegExp("^([a-zA-Z])"),q=function(a){return p.exec(a)?!0:!1},r=function(a,b){q(a)?(j.mode=1,j.account=a):(j.mode=2,j.phone=a),j.password=b,j.dev=returnCitySN.cip||"",j.type=4},s=function(){var h=g+"/user/personal";console.log("getAccData"),c.get(h).success(function(c){0==c.err&&(console.log("err = 0"),m=c.info,k.accType="cm",k.username=m.name,k.password=l.passwd,k.portrait=m.portrait,a.remember&&(i=30),console.log("usernameeeee,"+m.name),e.setCredentials(k,i),b.globals=f.get("globals")||{},console.log(b.globals),d.path("/customer/account"))}).error()};l.login=function(){var b=function(b){console.log("post success"),a.logSucceed=!0,0==b.err?(a.logSucceed=!0,a.acc=b,k.userID=b.accID,s()):(console.log("failed,"+b.error_code),a.logSucceed=!1),0==n.alerts.length&&n.alerts.push(o)},c=function(b){a.err=b};r(l.name,l.passwd),e.login(h,j).success(b).error(c)},QC.Login({btnId:"qqLoginBtn"})}])});